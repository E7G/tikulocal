# 字体配置说明

## 概述

题库管理系统已添加中文字体支持，解决了中文显示问题。程序会自动尝试加载支持中文的字体，确保界面和内容能够正确显示中文字符。

## 技术实现

### 自定义主题
创建了自定义主题结构体 `customTheme`，重写了 `Font()` 方法来支持中文字体：

```go
type customTheme struct {
    fyne.Theme
}

func (t *customTheme) Font(style fyne.TextStyle) fyne.Resource {
    // 字体加载逻辑
}
```

### 字体加载策略
程序采用多级字体加载策略：

1. **本地字体文件** - 优先加载项目内的字体文件
2. **系统字体** - 加载Windows系统自带的中文字体
3. **默认字体** - 使用Fyne默认字体作为后备

## 支持的字体

### 本地字体
- `fonts/NotoSansCJKsc-Regular.otf` - Google Noto Sans CJK 简体中文

### 系统字体（Windows）
- `C:/Windows/Fonts/msyh.ttc` - 微软雅黑
- `C:/Windows/Fonts/simsun.ttc` - 宋体  
- `C:/Windows/Fonts/simhei.ttf` - 黑体
- `C:/Windows/Fonts/simkai.ttf` - 楷体

## 字体优先级

程序按以下顺序尝试加载字体：

1. **本地字体文件**
   - 检查 `fonts/NotoSansCJKsc-Regular.otf` 是否存在
   - 如果存在且可加载，使用该字体
   - 记录加载成功或失败的日志

2. **系统字体**
   - 依次尝试加载Windows系统字体
   - 按微软雅黑 → 宋体 → 黑体 → 楷体的顺序
   - 记录每个字体的加载状态

3. **默认字体**
   - 如果所有中文字体都加载失败，使用Fyne默认字体
   - 确保程序不会因字体问题而崩溃

## 日志记录

程序会记录详细的字体加载日志：

```
成功加载本地字体: fonts/NotoSansCJKsc-Regular.otf
成功加载系统字体: C:/Windows/Fonts/msyh.ttc
使用Fyne默认字体
```

## 使用方法

### 自动配置
程序启动时会自动应用自定义主题，无需手动配置。

### 添加自定义字体
如需使用其他字体：

1. 将字体文件放入 `fonts/` 目录
2. 修改 `main.go` 中的 `customTheme.Font()` 方法
3. 在字体路径列表中添加新字体路径

### 字体文件要求
- 支持中文字符集
- 文件大小建议不超过10MB
- 支持格式：`.ttf`, `.otf`, `.ttc`

## 兼容性

### 跨平台支持
- **Windows**: 支持系统字体和本地字体
- **macOS**: 可扩展支持系统字体
- **Linux**: 可扩展支持系统字体

### 错误处理
- 字体文件不存在时自动跳过
- 字体加载失败时使用后备字体
- 详细的错误日志记录

## 性能优化

### 字体缓存
- Fyne会自动缓存加载的字体
- 避免重复加载相同的字体文件

### 内存管理
- 字体资源会在程序结束时自动释放
- 避免内存泄漏问题

## 故障排除

### 常见问题

1. **中文显示为方块**
   - 检查系统是否安装了中文字体
   - 查看日志确认字体加载状态

2. **字体加载失败**
   - 确认字体文件路径正确
   - 检查字体文件是否损坏
   - 查看详细错误日志

3. **程序启动缓慢**
   - 字体文件过大可能导致加载缓慢
   - 建议使用小于10MB的字体文件

### 调试方法

1. 查看控制台日志输出
2. 检查字体文件是否存在
3. 验证字体文件格式是否正确
4. 测试不同字体的加载情况

## 更新日志

### v1.2.4 (最新)
- ✨ 添加中文字体支持
- 🔧 创建自定义主题
- 📝 多级字体加载策略
- 🛡️ 完善的错误处理
- 📊 详细的日志记录

## 未来改进

### 计划功能
- 🎨 支持字体主题切换
- 📱 移动端字体优化
- 🌐 多语言字体支持
- ⚡ 字体加载性能优化 
# 题库管理系统 (TikuLocal)

一个基于Go语言开发的本地题库管理系统，支持DOCX文档解析、题目搜索和管理。

## 📋 目录

- [功能特性](#功能特性)
- [技术栈](#技术栈)
- [快速开始](#快速开始)
- [使用指南](#使用指南)
- [API接口](#api接口)
- [开发文档](#开发文档)
- [更新日志](#更新日志)
- [许可证](#许可证)

## ✨ 功能特性

### 🎯 核心功能
- **📄 DOCX文档解析**: 自动解析Word文档中的题目，支持多种题型
- **🔍 智能搜索**: 基于题目内容的模糊搜索功能
- **💾 本地数据库**: 使用SQLite数据库存储题目，数据安全可靠
- **🌐 Web API**: 提供RESTful API接口，支持外部系统调用
- **📊 数据管理**: 完整的增删改查功能，支持软删除和硬删除

### 🎨 界面特性
- **🎯 现代化UI**: 采用图标和emoji增强视觉效果
- **📱 响应式布局**: 优化窗口尺寸和组件布局
- **📊 实时统计**: 显示题库统计数据和题型分布
- **🎨 卡片式显示**: 直观的题目卡片布局
- **🔤 中文字体**: 完整的中文字体支持
- **📁 拖放支持**: 直接拖放DOCX文件到程序

### 🔧 高级功能
- **📄 文件拖放**: 支持直接拖放DOCX文件
- **🔄 分页浏览**: 高效的分页导航和跳转
- **🔍 智能解析**: 支持多种题型和选项格式
- **🛡️ 错误处理**: 完善的错误提示和处理机制
- **📝 日志记录**: 详细的操作日志和状态记录

## 🛠️ 技术栈

- **后端**: Go + Gin + GORM
- **数据库**: SQLite
- **GUI**: Fyne v2.6+
- **文档解析**: XML解析 (DOCX格式)
- **字体支持**: 自定义主题 + 多级字体加载

## 🚀 快速开始

### 环境要求
- Go 1.16+
- Windows/Linux/macOS

### 安装依赖
```bash
go mod tidy
```

### 运行程序
```bash
go run main.go
```

### 编译可执行文件
```bash
go build -o tikulocal.exe .
```

### 生成可执行文件
```bash
go install fyne.io/tools/cmd/fyne@latest
fyne package -os windows -icon icon.png
```

### 使用GitHub Actions构建
项目提供了GitHub Actions工作流来自动构建和发布：

1. **访问Actions页面**: 在GitHub仓库页面点击 "Actions" 标签
2. **选择工作流**: 选择 "构建题库管理系统" 或 "构建题库管理系统 (简化版)"
3. **配置参数**: 输入版本号和选择目标平台
4. **启动构建**: 点击 "Run workflow" 按钮

详细说明请查看 [GitHub Actions使用指南](docs/GITHUB_ACTIONS.md)

## 📖 使用指南

### 1. 解析DOCX文档

#### 方法一：拖放文件（推荐）
1. 直接将DOCX文件拖放到文件输入框
2. 程序会自动验证文件格式并显示文件名
3. 点击"🔍 解析文件"开始解析

#### 方法二：选择文件
1. 点击"📁 选择文件"按钮选择DOCX文档
2. 点击"🔍 解析文件"开始解析
3. 系统会自动提取题目并保存到数据库

### 2. 搜索题目
1. 在搜索框中输入题目关键词
2. 点击"🔍 搜索题目"进行搜索
3. 使用分页控件浏览搜索结果

### 3. 管理题目
- **➕ 添加题目**: 手动添加新题目
- **✏️ 编辑题目**: 修改现有题目内容
- **🗑️ 删除题目**: 支持软删除和硬删除
- **💥 清空题库**: 批量删除所有题目

### 4. 浏览题库
- 使用分页按钮浏览题目
- 在页码输入框中输入页码并跳转
- 点击"🔄 刷新"更新显示内容

## 🌐 API接口

程序启动后会在端口8060提供Web服务：

### 搜索接口
```http
POST /adapter-service/search
Content-Type: application/json

{
  "question": "题目内容",
  "options": ["选项A", "选项B", "选项C", "选项D"],
  "type": 0
}
```

### 状态检查
```http
GET /
HEAD /
```

## 📚 开发文档

### 核心文档
- [字体配置说明](docs/FONT_CONFIG.md) - 中文字体支持和配置
- [界面优化说明](docs/DISPLAY_IMPROVEMENT.md) - 界面显示优化
- [拖放功能说明](docs/DRAG_DROP_FIX.md) - 文件拖放功能
- [代码优化总结](docs/OPTIMIZATION.md) - 性能优化和代码改进
- [API接口文档](docs/API.md) - RESTful API接口详细说明
- [GitHub Actions使用指南](docs/GITHUB_ACTIONS.md) - 自动构建和发布说明

### 测试文档
- [卡片显示测试](docs/test_cards.md) - 卡片式显示功能测试
- [拖放功能测试](docs/test_drag_drop.md) - 文件拖放功能测试
- [字体功能测试](docs/test_font.md) - 字体加载功能测试

### 其他文档
- [详细变更日志](CHANGELOG.md) - 完整的版本变更历史
- [开发文档索引](docs/README.md) - 文档导航和快速指南

## 📝 更新日志

### v1.2.6 (最新)
- 📁 **测试文件整理**: 将测试文件移至独立test文件夹，主目录更整洁
- 🔧 **解析器优化**: 选项解析支持A-Z全字母，答案显示选项文本而非字母
- 🛠️ **代码重构**: 分离Question结构体至models.go，解决循环依赖问题
- ✅ **构建修复**: 解决main函数重复声明和结构体冲突问题
- 🧪 **测试验证**: 添加测试运行脚本，验证解析器修复效果
- 🔄 **删除功能优化**: 修复删除后无法重新导入相同问题
- 🛡️ **软删除支持**: 支持软删除和硬删除选项
- 🔄 **自动恢复**: 删除的题目重新导入时自动恢复
- 📊 **数据管理**: 完善的数据管理功能

### v1.2.4
- 🔤 **中文字体支持**: 完整的中文字体支持，解决显示问题
- 🎨 **自定义主题**: 创建自定义主题支持中文字体
- 📝 **多级加载**: 本地字体、系统字体、默认字体的多级加载策略
- 🛡️ **错误处理**: 完善的字体加载错误处理机制

### v1.2.3
- 🎨 **题目显示优化**: 全新的直观高效题目显示格式
- 🔘 **题型图标**: 为不同题型添加专属图标标识
- 📝 **引用格式**: 题目内容使用引用格式突出显示
- ✅ **答案高亮**: 答案使用代码格式高亮显示

### v1.2.2
- 🔧 **修复拖放功能**: 使用Fyne的正确`SetOnDropped`API
- 📚 **技术文档**: 添加详细的拖放功能修复说明
- 🛠️ **API升级**: 升级到Fyne 2.4+的官方拖放接口

### v1.2.1
- ✨ 修复并优化文件拖放功能
- 🔍 增强文件格式验证机制
- 🛡️ 改进错误处理和用户反馈

### v1.2.0
- ✨ 界面全面优化
- 🎨 添加图标和emoji
- 📊 增加统计信息显示
- 🔄 添加刷新和清空功能

### v1.0.0
- 🚀 初始版本发布
- 📄 DOCX文档解析
- 🔍 题目搜索功能
- 💾 SQLite数据库存储
- 🌐 Web API接口

## 📄 许可证

MIT License

---

**提示**：首次运行时，程序会自动创建SQLite数据库文件。导入题目后，可以通过Web API接口查询题库内容。

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个项目！

## 📞 支持

如果遇到问题，请查看[开发文档](#开发文档)或提交Issue。